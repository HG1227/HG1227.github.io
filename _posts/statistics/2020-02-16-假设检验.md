---
layout: post
title:  假设检验
date:   2020-02-16
categories: statistics
tags:  
---
* content
{:toc}










参数估计和假设检验

**参数估计**( parameter estimation) 和 **假设检验 ** ( hypothesis testing) 是统计推断的两个组成部分，它们都是利用样本对总体进行某种推断，但推断的角度不同。参数估计讨论的是用样本统计量估计总体参数的方法，总体参数 $μ$ 在估计前是未知的。而在假设检验中，则是先对 $μ$ 的值提出一个假设，然后利用样本信息去检验这个假设是否成立。



**假设检验 **( hypothesis testing) 

包括参数和非参数检验：

- 参数假设检验（parametric test）：总体的 分布形式已知，需要对总体的未知参数进行 假设检验。
- 非参数假设检验（non-parametric test）：对 总体分布形式所知甚少，需对未知分布函数 的形式及其他特征进行假设检验。 

参数假设检验举例

> 例1: 根据1989年的统计资料，某地女性新生儿的平均体重为3190 克。为判断该地1990年的女性新生儿体重与1989年相比有无显 著差异，从该地1990年的女性新生儿中随机抽取30人，测得其 平均体重为3210克。从样本数据看，1990年女新生儿体重比 1989年略高，但这种差异可能是由于抽样的随机性带来的，也 许这两年新生儿的体重并没有显著差异。究竟是否存在显著差 异？可以先假设这两年新生儿的体重没有显著差异，然后利用 样本信息检验这个假设能否成立。这是一个关于总体均值的假 设检验问题。

假设检验的原理

小概率原理。假设检验 的基本思想是概率性质的**反证法**。(不同于纯数 学中的反证法)

什么是小概率？

- 概率是0～1之间的一个数，因此小概率就是接近0的一个 数 
-  著名的英国统计家 Ronald Fisher 把 20 分之 1 作为标准，也 就是0.05，从此0.05或比0.05小的概率都被认为是小概率 
-  Fisher没有任何深奥的理由解释他为什么选择0.05，只是 说他忽然想起来的

什么时小概率原理

- **小概率原理**——发生概率很小的随机事件（小概率事件） 在一次实验中几乎是不可能发生的。

- 根据这一原理，可以先假设总体参数的某项取值为真， 也就是假设其发生的可能性很大，然后抽取一个样本 进行观察，如果样本信息显示出现了与事先假设相反 的结果且与原假设差别很大，则说明原来假定的小概 率事件在一次实验中发生了，这是一个违背小概率原 理的不合理现象，因此有理由怀疑和拒绝原假设；否 则不能拒绝原假设。 
- 检验中使用的小概率是检验前人为指定的。

小概率原理举例

某工厂质检部门规定该厂产品次品率不超过4％方能 出厂。今从1000件产品中抽出10件，经检验有4件次 品，问这批产品是否能出厂? 

如果假设这批产品的次品率P≤4％，则可计算事件 “抽10件产品有4件次品”的出现概率为：
$$
\begin{equation}P_{10}(4)=C_{10}^{4}(0.04)^{4}(1-0.04)^{6}=0.00042\end{equation}
$$
可见，概率是相当小的，1万次实验中可能出现4次， 然而概率如此小的事件，在一次实验中居然发生了， 这是不合理的，而不合理的根源在于假设次品率 P≤4％ ，因而认为假设次品率P≤4％是不能成立的， 故按质检部门的规定，这批产品不能出厂。

假设检验的基本思想

<center><img src="https://raw.githubusercontent.com/HG1227/image/master/img_tuchuang/20200609153120.png"/></center>

假设检验的两个特点

- 第一，**假设检验采用逻辑上的反证法**，即为了检验 一个假设是否成立，首先假设它是真的，然后对 样本进行观察，如果发现出现了不合理现象，则 可以认为假设是不合理的，拒绝假设。否则可以 认为假设是合理的，接受假设。
- 第二，假设检验采用的反证法带有概率性。所谓假 设的不合理不是绝对的，而是基于实践中广泛采用的 小概率事件几乎不可能发生的原则。至于事件的概率 小到什么程度才算是小概率事件，并没有统一的界定 标准，而是必须根据具体问题而定。如果一旦判断失 误，错误地拒绝原假设会造成巨大损失，那么拒绝原 假设的概率就应定的小一些；如果一旦判断失误，错 误地接受原假设会造成巨大损失，那么拒绝原假设的 概率就应定的大一些。
- 小概率通常用 $α$ 表示，又称为**检验的显著性水平**。通 常取 $α$ ＝0.05 或 $α$ ＝0.01，即把概率不超过 0.05 或 0.01 的事 件当作小概率事件。

原假设和备择假设

假设检验中，我们称作为检验对象的待检验假 设为**原假设或零假设**，用 $H_0$表示。原假设的对立假设称为**备择假设或备选假设**，用 $H_1$表示。

若证明 $H_0$ 为真，则 $H_1$ 为假；若 $H_0$ 为假，则 $H_1$ 为真。

例如，设 $\bar{x}_0$ 为总体均值 $\bar{X}$ 的某一确定值。

（1）对于总体均值是否等于某一确定值的**原假设**可以表示为：
$$
\begin{equation}\mathrm{H}_{0}: \quad \mathrm{X}=\overline{\mathrm{X}}_{0} \quad\left(\text { 如 } \mathrm{H}_{0}: \quad \overline{\mathrm{X}}=3190 \text { 克 }\right)\end{equation}
$$
其对应的**备择假设**则表示为：
$$
\begin{equation}\mathrm{H}_{1}: \quad \mathrm{X} \neq \overline{\mathrm{X}}_{\mathrm{o}} \quad\left(\text { 如 } \mathrm{H}_{1}: \quad \overline{\mathrm{X}} \neq 3190\text { 克) }\right.\end{equation}
$$
（2）对于总体均值 $\bar{X}$ 是否大于某一确定值 $\bar{X}_0$  的**原假设**可以表示为：
$$
\begin{equation}\mathrm{H}_{\mathrm{o}}: \overline{\mathrm{X}} \geq \overline{\mathrm{X}}_{\mathrm{o}}\left(如\mathrm{H}_{\mathrm{o}}: \overline{\mathrm{X}} \geq 2000 \text { 克}\right)\end{equation}
$$
其对应的备择假设则表示为：
$$
\begin{equation}\mathrm{H}_{1}: \quad \overline{\mathrm{X}}<\overline{\mathrm{X}}_{\mathrm{o}} \quad\left(如\mathrm{H}_{1}: \quad \overline{\mathrm{X}}<2000 \text { 克}\right)\end{equation}
$$
（3）对于总体均值 $\bar{X}$ 是否小于某一确定值 $\bar{X}_0$   的原假设可以表示为：
$$
\begin{equation}\mathrm{H}_{0}: \quad \overline{\mathrm{X}} \leq \overline{\mathrm{X}}_{0} \quad\left(如\mathrm{H}_{0}: \quad \overline{\mathrm{X}} \leq 5 \%\right)\end{equation}
$$


其对应的备择假设则表示为：
$$
\begin{equation}\mathrm{H}_{1}: \quad \overline{\mathrm{X}}>\overline{\mathrm{X}}_{\mathrm{o}}\left(\text { 如 } \mathrm{H}_{1}: \quad \overline{\mathrm{X}}>5 \%\right)\end{equation}
$$
**注意：原假设总是有等号： $=$ 或 $≤$ 或 $≥$。** 

双侧检验和单侧检验

根据假设的形式不同，假设检验可以分为**双侧假设检验**和**单侧假设检验**。

<center><img src="https://raw.githubusercontent.com/HG1227/image/master/img_tuchuang/20200609160929.png"/></center>

双侧检验与单侧检验的(假设的形式)

<center><img src="https://raw.githubusercontent.com/HG1227/image/master/img_tuchuang/20200609162332.png"/>
</center>



**双侧检验**：只强调差异而不强调方向性的 检验称为双侧检验。

**单侧检验**：强调某一方向的检验称为单侧 检验。又分左侧检验和右侧检验。 通常适用于检验某一参数是否“大于”或 “优于”、“快于”及“小于”、“劣 于”、“慢于”另一参数等一类问题。





假设检验中的拒绝域和接受域

在规定了检验的显著性水平 $α$ 后，根据容量为 n 的样本，按照统计量的理论概率分布规律，可以确定据以判断拒绝和接受原假设的检验统计量的**临界值**。

**临界值**将统计量的所有可能取值区间分为两互不相交的部分，即原假设的拒绝域和接受域。

**接受域**: 原假设为真时允许范围内的变动，应该接受原假设。

**拒绝域**: 当原假设为真时只有很小的概率出现，因而当统计量的结果落入这一区域便应拒绝原假设，这一区域便称作拒绝域。

<center><img src="https://raw.githubusercontent.com/HG1227/image/master/img_tuchuang/20200609164249.png"/></center>







假设检验的两类错误

根据假设检验做出判断无非下述四种情况： 

1、原假设真实， 并接受原假设，判断正确；

2、原假设不真实，且拒绝原假设，判断正确； 

3、原假设真实， 但拒绝原假设，判断错误； 

4、原假设不真实，却接受原假设，判断错误。 

假设检验是依据样本提供的信息进行判断，有犯错误的可能。所 犯错误有两种类型：

- 第一类错误是原假设 $H_0$ 为真时，检验结果把它当成不真而 拒绝了。犯这种错误的概率用 $α$ 表示，也称作 $α$ 型错误或弃真错误。
- 第二类错误是原假设 $H_0$不为真时，检验结果把它当成真而 接受了。犯这种错误的概率用 $β$ 表示，也称作 $β$ 型错误或取伪错误。

正确决策和犯错误的概率何以归纳为下表

<center><img src="https://raw.githubusercontent.com/HG1227/image/master/img_tuchuang/20200609171010.png"/></center>

两类错误关系的图示

<center><img src="https://raw.githubusercontent.com/HG1227/image/master/img_tuchuang/20200609171627.png"/></center>

两类错误的关系

在样本容量n一定的情况下，假设检验不能同时做到犯 α 和 β 两类错误的概率都很小。若减小α错误，就会增大犯β 错误的机会；若减小β错误，也会增大犯α错误的机会。 要使α和β同时变小只有增大样本容量。但样本容量增加 要受人力、经费、时间等很多因素的限制，无限制增加 样本容量就会使抽样调查失去意义。因此假设检验需要 慎重考虑对两类错误进行控制的问题。





假设检验的步骤

(一)、根据研究需要提出原假设 $H_0$ 和备择假设 $H_1$

(二)、确定适当的检验统计量

(三)、确定显著性水平 $\alpha$ 和临界值及拒绝域

(四)、根据样本数据计算检验统计量的值(或 $p$ 值)

(五)、做出决策：(两种方法)

​		(1)、将检验统计量的值和临界值比较，做出拒绝或接受原假设的决策。

​		(2)、由步骤五的检验统计量计算 $p$ 值，利用 $p$ 值确定时候拒绝原假设。

备注：

(一)、根据研究需要提出原假设 $H_0$ 和备择假设 $H_1$ 

应该注意：

⑴对任一假设检验问题，其所有可能结果均 应包括在所提出的两个对立假设中，原假 设与对立假设总有一个、也只能有一个成 立。 

⑵原假设一定要有等号： =或 ≤ 或 ≥。 原假设不是随意提出的，应该本着“不轻 易拒绝原假设”的原则。

双侧检验原假设和备择假设的确定

双侧检验属于决策中的假设检验。即不论是拒绝 H0 还是接受 H0，都必需采取相应的行动措施。

例如，某某种零件的尺寸，要求其平均长度为 10厘米，大于或小于10厘米均属于不合格。 待检验问题是该企业生产的零件平均长度是10厘米吗?(属于决策中的假设)则建立的原假 设与备择假设应为
$$
\begin{equation}H_{0}: \bar{X}=10 \quad H_{1}: \bar{X} \neq 10\end{equation}
$$
单侧检验原假设和备择假设的确定

应区别不同情况采取不同的建立假设方法。

对于检验某项研究是否达到了预期效果

一般是将研究的预期效果（**希望、想要证明的假设**） 作为备择假设H1，将认为研究结果无效作为原假设 H0。先确立备择假设H1。因为只有当检验结果与原 假设有明显差别时才能拒绝原假设而接受备择假设， 原假设不会轻易被拒绝，就使得希望得到的结论不 会轻易被接受，从而减少结论错误。

例如 ：有研究预计，采用新技术生产后将会使某产品的使用 寿命明显延长到1500小时以上。则建立的原假设与备择假设
$$
\begin{equation}\mathrm{H}_{\mathrm{o}}: \overline{\mathrm{X}} \leq 1500 \quad \mathrm{H}_{1}: \overline{\mathrm{X}}>1500\end{equation}
$$
例如，有研究预计，改进生产工艺后会使某产品的废品率降 低到2%以下。则建立的原假设与备择假设应为：
$$
\begin{equation}\mathrm{H}_{\mathrm{o}}: \overline{\mathrm{X}} \geq 2 \% \quad \mathrm{H}_{1}: \overline{\mathrm{X}}<2 \%\end{equation}
$$


对于检验某项声明的有效性

一般可将所作的声明作为原假设。将对该声明的质疑作为备择假设。先确立原假设H0。因为除非有证 据表明“声明”无效，否则就应认为该“声明”是 有效的。

例如，某灯泡制造商声称，该企业生产的灯泡平均 使用寿命在1000小时以上。通常除非样本能提供证 据表明使用寿命在1000小时以下，否则就应认为厂 商的声称是正确的。建立的原假设与备择假设应为：
$$
\begin{equation}\mathrm{H}_{\mathrm{o}}: \overline{\mathrm{X}} \geq 1000 \quad \mathrm{H}_{1}: \quad \overline{\mathrm{X}}<1000\end{equation}
$$
(二)、确定适当的检验统计量

假设检验根据检验内容和条件不同需要采用不同的检验 统计量。

在一个正态总体的参数检验中，Z 统计量和 t 统计量常用于**均值**和**比例**的检验，χ2 统计量用于**方差**的检验。**选择统计量需考虑的因素有被检验的参数类型、总体方差是否已知、用于检验的样本量大小等。**

<center><img src="https://raw.githubusercontent.com/HG1227/image/master/img_tuchuang/20200609173521.png"/></center>

(三)、确定显著性水平 $\alpha$ 和临界值及拒绝域

- 显著性水平α是当原假设为正确时被拒绝的概率， 是由研究者事先确定的。 
- 显著性水平的大小应根据研究需要的精确度和可 靠性而定。通常取α＝0.05或α＝0.01，即接受原 假设的决定是正确的可能性（概率）为95％或99 ％。
-  根据给定的显著性水平α，查表得出相应的临界 值，同时指定拒绝域。

(四)、根据样本数据计算检验统计量的值(或 $p$ 值)

(五)、做出决策

 例如，总体标准差σ已知时根据样本均值计算统计 量Z的公式为
$$
\begin{equation}Z=\frac{\bar{x}-\bar{X}}{\sigma / \sqrt{n}}\end{equation}
$$
如果检验统计量的值落入拒绝域，则拒绝原 假设，接受备择假设；如果检验统计量的值 落入接受域，则接受原假设，拒绝备择假设。

